
var RSA = require('./rsa.js').RSA;


var encrypt = function (n, str) {
    var rsa = new RSA();
    rsa.setPublic(n, e);
    var res = rsa.encrypt(str);
    return res;
};

var decrypt = function (n, d, str) {
    var rsa = new RSA();
    rsa.setPrivate(n, e, d);
    var res = rsa.decrypt(str);
    return res;
};

var generateRSA = function () {
    var rsa = new RSA();
    rsa.generate('1024', '3');
    return rsa;
};

var importPrivateKey = function (n, e, d) {
    var rsa = new RSA();
    rsa.setPrivate(n, e, d);
    return rsa;
};

var importPublicKey = function (n, e) {
    var rsa = new RSA();
    rsa.setPublic(n, e);
    return rsa;
};

exports.encrypt = encrypt;
exports.decrypt = decrypt;
exports.generateRSA = generateRSA;
exports.importPrivateKey = importPrivateKey;
exports.importPublicKey = importPublicKey;
